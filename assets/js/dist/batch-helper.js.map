{"version":3,"file":"batch-helper.js","mappings":";YASA,MAAMA,EAAIC,OAEJC,EAAQ,CAEbC,MAAOH,EAAG,eAEVI,KAAMJ,EAAG,qBAAsB,eAE/BK,KAAML,EAAG,WAAY,iBAKrBM,MAAO,WACNC,KAAKH,KAAKI,KAAM,YAAY,GAC5BD,KAAKJ,MAAMM,YAAa,WACxBT,EAAG,aAAcU,IAAK,IACvB,EAKAC,QAAS,WACRT,EAAMC,MAAMS,SAAU,WACtBV,EAAME,KAAKI,KAAM,YAAY,GAC7BN,EAAMG,KAAKQ,QACXX,EAAMY,QAAS,uBACfZ,EAAMa,MACP,EAKAA,KAAM,WACLR,KAAKJ,MAAMa,WAAY,CACtBC,QAAS,SAAWC,GACnB,GAAKA,EAAOD,QAEX,GADAf,EAAMY,QAASI,EAAOC,SACjBD,EAAOE,KAAO,CAClB,MAAMC,EAAUrB,EAAG,aACnBqB,EAAQX,IAAKY,SAAUD,EAAQX,MAAO,IAAO,GAC7CR,EAAMa,MACP,MACCb,EAAMY,QAASS,aAAaC,KAAM,WAClCtB,EAAMI,aAGPJ,EAAMuB,SAAUP,EAAOC,SACvBjB,EAAMI,OAER,EACAoB,MAAO,SAAWC,EAAKC,EAAQF,GAC9BxB,EAAMuB,SAAUC,GAChBxB,EAAMI,OACP,GAEF,EAQAQ,QAAS,SAAWe,EAAKC,GACxB,MAAMC,EAAK/B,EAAG,WACd+B,EAAGC,KAAMH,GACJC,GACJC,EAAGnB,SAAUkB,GAEdvB,KAAKF,KAAK4B,OAAQF,EACnB,EAOAN,SAAU,SAAWI,GACpBtB,KAAKO,QAAS,WAAae,EAAK,QACjC,EAOAK,QAAS,SAAWC,GACnBnC,EAAG,aAAcU,IAAKyB,EACvB,GAGDjC,EAAMC,MAAMiC,QAAQ,SAAWC,GAC9BA,EAAEC,iBACItC,EAAGO,MAAOgC,KAAM,mCAAoCC,OAE9CC,QAASlB,aAAakB,UACjCvC,EAAMS,UAFNT,EAAMuB,SAAUF,aAAamB,MAI/B","sources":["webpack://wpametu/./assets/js/src/batch-helper.js"],"sourcesContent":["/*!\n * Batch helper\n *\n * @handle wpametu-batch-helper\n * @deps jquery-form, jquery-effects-highlight\n */\n\n/*global WpametuBatch: true*/\n\nconst $ = jQuery;\n\nconst Batch = {\n\n\t$form: $( '#batch-form' ),\n\n\t$btn: $( 'input[type=submit]', '#batch-form' ),\n\n\t$pre: $( '.console', '#batch-result' ),\n\n\t/**\n\t * Reset form\n\t */\n\treset: function () {\n\t\tthis.$btn.attr( 'disabled', false );\n\t\tthis.$form.removeClass( 'loading' );\n\t\t$( '#page_num' ).val( '1' );\n\t},\n\n\t/**\n\t * Execute batch\n\t */\n\texecute: function () {\n\t\tBatch.$form.addClass( 'loading' );\n\t\tBatch.$btn.attr( 'disabled', true );\n\t\tBatch.$pre.empty();\n\t\tBatch.console( 'Start Processing...' );\n\t\tBatch.ajax();\n\t},\n\n\t/**\n\t * Send request\n\t */\n\tajax: function () {\n\t\tthis.$form.ajaxSubmit( {\n\t\t\tsuccess: function ( result ) {\n\t\t\t\tif ( result.success ) {\n\t\t\t\t\tBatch.console( result.message );\n\t\t\t\t\tif ( result.next ) {\n\t\t\t\t\t\tconst curPage = $( '#page_num' );\n\t\t\t\t\t\tcurPage.val( parseInt( curPage.val(), 10 ) + 1 );\n\t\t\t\t\t\tBatch.ajax();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tBatch.console( WpametuBatch.done, 'success' );\n\t\t\t\t\t\tBatch.reset();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tBatch.addError( result.message );\n\t\t\t\t\tBatch.reset();\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function ( xhr, status, error ) {\n\t\t\t\tBatch.addError( error );\n\t\t\t\tBatch.reset();\n\t\t\t}\n\t\t} );\n\t},\n\n\t/**\n\t * Add message to console\n\t *\n\t * @param {string} msg\n\t * @param {string} className\n\t */\n\tconsole: function ( msg, className ) {\n\t\tconst $p = $( '<p></p>' );\n\t\t$p.text( msg );\n\t\tif ( className ) {\n\t\t\t$p.addClass( className );\n\t\t}\n\t\tthis.$pre.append( $p );\n\t},\n\n\t/**\n\t * Add error message\n\t *\n\t * @param {string} msg\n\t */\n\taddError: function ( msg ) {\n\t\tthis.console( '[Error] ' + msg, 'error' );\n\t},\n\n\t/**\n\t * Set page number\n\t *\n\t * @param {number} pageNum\n\t */\n\tsetPage: function ( pageNum ) {\n\t\t$( '#page_num' ).val( pageNum );\n\t}\n};\n\nBatch.$form.submit( function ( e ) {\n\te.preventDefault();\n\tif ( !$( this ).find( 'input[name=batch_class]:checked' ).length ) {\n\t\tBatch.addError( WpametuBatch.alert );\n\t} else if ( confirm( WpametuBatch.confirm ) ) {\n\t\tBatch.execute();\n\t}\n} );\n"],"names":["$","jQuery","Batch","$form","$btn","$pre","reset","this","attr","removeClass","val","execute","addClass","empty","console","ajax","ajaxSubmit","success","result","message","next","curPage","parseInt","WpametuBatch","done","addError","error","xhr","status","msg","className","$p","text","append","setPage","pageNum","submit","e","preventDefault","find","length","confirm","alert"],"sourceRoot":""}