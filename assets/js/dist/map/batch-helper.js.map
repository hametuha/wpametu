{"version":3,"sources":["batch-helper.js"],"names":["$","Batch","$form","$btn","$pre","reset","this","attr","removeClass","val","execute","addClass","empty","console","ajax","ajaxSubmit","success","result","message","next","curPage","parseInt","WpametuBatch","done","addError","error","xhr","status","msg","className","$p","text","append","setPage","pageNum","submit","e","preventDefault","find","length","confirm","alert","jQuery"],"mappings":"CAMA,SAAWA,GACP,YAEA,IAAIC,EAEJA,IAEIC,MAAOF,EAAE,eAETG,KAAMH,EAAE,qBAAsB,eAE9BI,KAAMJ,EAAE,WAAY,iBAKpBK,MAAO,WACHC,KAAKH,KAAKI,KAAK,YAAY,GAC3BD,KAAKJ,MAAMM,YAAY,WACvBR,EAAE,aAAaS,IAAI,MAMvBC,QAAS,WACLT,EAAMC,MAAMS,SAAS,WACrBV,EAAME,KAAKI,KAAK,YAAY,GAC5BN,EAAMG,KAAKQ,QACXX,EAAMY,QAAQ,uBACdZ,EAAMa,QAMVA,KAAM,WACFR,KAAKJ,MAAMa,YACPC,QAAS,SAASC,GACd,GAAIA,EAAOD,QAEP,GADAf,EAAMY,QAAQI,EAAOC,SACjBD,EAAOE,KAAM,CACb,GAAIC,GAAUpB,EAAE,YAChBoB,GAAQX,IAAIY,SAASD,EAAQX,MAAO,IAAM,GAC1CR,EAAMa,WAENb,GAAMY,QAAQS,aAAaC,KAAM,WACjCtB,EAAMI,YAGVJ,GAAMuB,SAASP,EAAOC,SACtBjB,EAAMI,SAGdoB,MAAO,SAASC,EAAKC,EAAQF,GACzBxB,EAAMuB,SAASC,GACfxB,EAAMI,YAWlBQ,QAAS,SAASe,EAAKC,GACnB,GAAIC,GAAK9B,EAAE,UACX8B,GAAGC,KAAKH,GACJC,GACAC,EAAGnB,SAASkB,GAEhBvB,KAAKF,KAAK4B,OAAOF,IAQrBN,SAAU,SAASI,GACftB,KAAKO,QAAQ,WAAae,EAAK,UAQnCK,QAAS,SAASC,GACdlC,EAAE,aAAaS,IAAIyB,KAK3BjC,EAAMC,MAAMiC,OAAO,SAASC,GACxBA,EAAEC,iBACGrC,EAAEM,MAAMgC,KAAK,mCAAmCC,OAE3CC,QAAQlB,aAAakB,UAC3BvC,EAAMS,UAFNT,EAAMuB,SAASF,aAAamB,UAMrCC","file":"batch-helper.js","sourcesContent":["/**\n * Description\n */\n\n/*global WpametuBatch: true*/\n\n(function ($) {\n    'use strict';\n\n    var Batch;\n\n    Batch = {\n\n        $form: $('#batch-form'),\n\n        $btn: $('input[type=submit]', '#batch-form'),\n\n        $pre: $('.console', '#batch-result'),\n\n        /**\n         * Reset form\n         */\n        reset: function () {\n            this.$btn.attr('disabled', false);\n            this.$form.removeClass('loading');\n            $('#page_num').val('1');\n        },\n\n        /**\n         * Execute batch\n         */\n        execute: function(){\n            Batch.$form.addClass('loading');\n            Batch.$btn.attr('disabled', true);\n            Batch.$pre.empty();\n            Batch.console('Start Processing...');\n            Batch.ajax();\n        },\n\n        /**\n         * Send request\n         */\n        ajax: function(){\n            this.$form.ajaxSubmit({\n                success: function(result){\n                    if( result.success ){\n                        Batch.console(result.message);\n                        if( result.next ){\n                            var curPage = $('#page_num');\n                            curPage.val(parseInt(curPage.val(), 10) + 1);\n                            Batch.ajax();\n                        }else{\n                            Batch.console(WpametuBatch.done, 'success');\n                            Batch.reset();\n                        }\n                    }else{\n                        Batch.addError(result.message);\n                        Batch.reset();\n                    }\n                },\n                error: function(xhr, status, error ){\n                    Batch.addError(error);\n                    Batch.reset();\n                }\n            });\n        },\n\n        /**\n         * Add message to console\n         *\n         * @param {String} msg\n         * @param {String} className\n         */\n        console: function(msg, className){\n            var $p = $('<p></p>');\n            $p.text(msg);\n            if( className ){\n                $p.addClass(className);\n            }\n            this.$pre.append($p);\n        },\n\n        /**\n         * Add error message\n         *\n         * @param {String} msg\n         */\n        addError: function(msg){\n            this.console('[Error] ' + msg, 'error');\n        },\n\n        /**\n         * Set page number\n         *\n         * @param {Number} pageNum\n         */\n        setPage: function(pageNum){\n            $('#page_num').val(pageNum);\n        }\n\n    };\n\n    Batch.$form.submit(function(e){\n        e.preventDefault();\n        if( !$(this).find('input[name=batch_class]:checked').length ){\n            Batch.addError(WpametuBatch.alert);\n        }else if( confirm(WpametuBatch.confirm) ){\n            Batch.execute();\n        }\n    });\n\n})(jQuery);\n"],"sourceRoot":"/source/"}